1.171
1.1832
1.4204000000000001
1.4204000000000001
1.1439999999999999
1.1439999999999999
1.0254000000000001
0.88859999999999995
1.163
0.98499999999999999
0.94179999999999997
2.9573999999999998
2.5091999999999999
1.343
1.3540000000000001
0.99619999999999997
1.1037999999999999
1.2203999999999999
1.3752
Reprojection errors before optimization:
49.920236798015431
78.656018737678139
57.349362005381025
108.75852959238345
96.992542380191821
26.690248730803745
51.074685258805729
67.395145082728078
95.347085679928668
67.18342777628385
30.167226760151653
31.822330637708859
93.499849927436614
43.240637915797343
44.87812202551563
47.294292254797014
73.552242961295917
37.634929177711491
80.268129637790267
84.507282694925891
47.907316764453491
63.32420382229504
77.412304760629979
51.274308163054258
97.072485821314885
55.474150001389845
42.138725198524689
137.39723614378713
70.48625641074824
68.76988385540794
85.035203713323028
113.19585740772528
75.687195300505977
86.113789688420212
72.668624042342614
38.230089586247807
72.999592750110409
58.417134999979794
84.36416444517333
41.210007110401385
80.78877495966573
113.39722128422821
39.687997560066229
65.875451088501038
52.07731585850923
75.161182960182515
93.340166881770671
13.910924631288299
7.7807663382840255
18.768477495213475
22.162421611291077
103.92207234383092
85.299865068109099
21.069456892820241
42.67445461996352
54.783652390648903
72.421832960673299
59.587193520909118
31.194104615985069
50.963281271304737
75.348696934254363
111.43417027113381
22.112777862793131
86.714518670181818
111.51141410125551
56.12107107961171
43.287376703348762
41.012015562427671
113.88001634677613
41.389386453703274
69.846211163845851
66.32647037850144
75.119989887589512
82.216079490661485
21.893380949452663
15.960550972102526
98.493176241446761
64.104011499297016
31.332871415337845
Pose errors before optimization:
0
0.057002116526658778
0.19279865363944967
0.19036171268464799
0.1001109273027541
Map errors before optimization:
0.1032679400422767
0.057800726907517384
0.080849346022171711
0.12452808538144797
0.10462443890222627
0.1299405486018711
0.13442696197766729
0.053515999833590594
0.034227101522902391
0.12263240435423844
0.070148991280094664
0.077576446717027861
0.091786077750303341
0.10307298322057012
0.079258127902746556
0
0.10654374340577467
0.10756497141493063
0.075904018321179018
iter      cost      cost_change  |gradient|   |step|    tr_ratio  tr_radius  ls_iter  iter_time  total_time
   0  4.998882e+03    0.00e+00    1.66e+03   0.00e+00   0.00e+00  1.00e+04        0    9.80e-05    2.56e-04
   1  2.134074e+02    4.79e+03    2.38e+03   5.58e-01   1.90e+00  3.00e+04        1    2.92e-04    5.62e-04
   2  5.666203e+01    1.57e+02    1.20e+03   1.19e+00   1.51e+00  9.00e+04        1    1.65e-04    7.36e-04
   3  4.601243e+01    1.06e+01    5.55e+02   1.98e+00   1.19e+00  2.70e+05        1    1.55e-04    8.98e-04
   4  4.347255e+01    2.54e+00    3.17e+02   3.15e+00   1.20e+00  8.10e+05        1    1.52e-04    1.06e-03
   5  4.195257e+01    1.52e+00    3.02e+02   3.68e+00   1.11e+00  2.43e+06        1    1.51e-04    1.22e-03
   6  4.104417e+01    9.08e-01    3.05e+02   1.03e+00   1.01e+00  7.29e+06        1    1.50e-04    1.37e-03
   7  4.059754e+01    4.47e-01    1.96e+02   6.06e+00   9.07e-01  1.58e+07        1    1.49e-04    1.53e-03
   8  4.026707e+01    3.30e-01    1.22e+02   1.65e+00   9.54e-01  4.75e+07        1    1.49e-04    1.68e-03
   9  4.007297e+01    1.94e-01    6.05e+01   2.62e+00   8.73e-01  8.10e+07        1    1.49e-04    1.84e-03
  10  3.997278e+01    1.00e-01    3.80e+01   4.92e+00   7.61e-01  9.44e+07        1    1.49e-04    2.00e-03
  11  3.992780e+01    4.50e-02    2.63e+01   1.03e+01   7.47e-01  1.07e+08        1    1.49e-04    2.15e-03
  12  3.990887e+01    1.89e-02    1.71e+01   2.10e+01   7.25e-01  1.18e+08        1    1.48e-04    2.31e-03
  13  3.990096e+01    7.91e-03    1.05e+01   3.47e+01   7.62e-01  1.38e+08        1    1.48e-04    2.46e-03
  14  3.989815e+01    2.81e-03    4.99e+00   4.70e+01   8.02e-01  1.77e+08        1    1.48e-04    2.62e-03
  15  3.989704e+01    1.11e-03    3.23e+00   6.28e+01   8.04e-01  2.28e+08        1    1.48e-04    2.77e-03
  16  3.989649e+01    5.54e-04    2.32e+00   8.23e+01   7.98e-01  2.89e+08        1    1.48e-04    2.93e-03
  17  3.989617e+01    3.22e-04    1.98e+00   1.05e+02   7.95e-01  3.64e+08        1    1.54e-04    3.09e-03
  18  3.989596e+01    2.05e-04    2.20e+00   1.33e+02   7.94e-01  4.56e+08        1    1.49e-04    3.24e-03
  19  3.989582e+01    1.38e-04    1.53e+00   1.68e+02   7.93e-01  5.71e+08        1    1.48e-04    3.40e-03
  20  3.989573e+01    9.70e-05    9.33e-01   2.11e+02   7.93e-01  7.15e+08        1    1.48e-04    3.55e-03
  21  3.989566e+01    7.02e-05    5.49e-01   2.64e+02   7.93e-01  8.96e+08        1    1.49e-04    3.71e-03
  22  3.989560e+01    5.20e-05    4.20e-01   3.31e+02   7.94e-01  1.12e+09        1    1.49e-04    3.86e-03
Reprojection errors after optimization:
0.35439006847720617
0.5854016636415833
0.80055408972404996
0.6661833440379169
0.31532185229231396
0.58274234329576591
1.1924228442690599
0.15800707967024313
2.2958432925405874
0.34266242912364914
0.90631097928887938
3.0195045265880625
0.59699484824979276
0.32027653910716303
0.7254926753761719
0.95917440457146574
0.089841739966571132
1.0836121480978842
0.44454506493385021
0.59767094082769778
1.5043731697876503
0.50381475935078701
1.3360144012164856
1.5165691228827196
0.46819576346480013
0.23398373282027796
0.72197860264403679
0.59321301104350088
1.6425176521676188
0.70168905515310898
0.23741342528670803
0.22801286383967911
0.61287499167577131
2.6460137780338542
0.41969099070272398
0.42616284492317663
0.41526166407760184
0.91023656211427795
1.6465162556672301
0.34645014203294067
1.3759910361605523
0.47834416842809269
0.13887284216927334
0.72173130494265458
0.46056178460873709
1.5889158999776885
0.4415448565945338
0.30705492534783918
0.30388516280693217
0.64823557702934376
0.46889431048703789
0.87424971441826871
0.52614332556413934
2.0276243951995734
0.58010413531506555
0.84849880698760693
0.71248872936000751
0.29544943122754247
1.9178678019890141
1.2578446331803883
1.5392568071344126
0.68739852325028938
3.5921750691901604
0.13903659199008986
3.4598165558029419
1.9404767218216348
0.5271425035107139
0.52564964639592549
0.31867261603219865
0.15824238898494222
0.012672088471057453
1.5770183744771271
0.3565179269437419
1.1839040596207375
0.44084073194032924
1.1257406969767549
1.0905113029620908
0.81096230547678838
2.2714459067307908
Pose errors after optimization:
0
0.016424707006456873
0.021445867328087592
0.027286074810309393
0.038493247348242332
Map errors after optimization:
0.36424188460076729 | 0.72688446871620971 0.19295236199472934  1.0006107406876317
0.33569179594020004 | 0.71440530112624556 0.31490037734909404 0.99747799127947689
0.48244118065288505 | 0.57716932945071753 0.33319562182083079  1.0276424925006935
0.46601562995688067 | 0.54154877377083344 0.18870233837013795 0.99988794689157789
0.28437290672193072 | 0.7105047880788733 0.8536380459254993 1.0785024097277756
0.14057464220234531 | 0.60902632781967347 0.93521191068384868 0.98669807038259405
0.39058233524787267 | 0.87578975133244708 0.68689877605071703  1.0532952924015371
0.1781773733856051 | 0.94331907799840509 0.73274669494646416 0.90236433119915171
0.17869067391362314 | 0.45633098821654355  1.2758423232468488 0.63673247791319709
0.25681347950645306 | 0.81659108865352481 0.47572158021871935  1.1078436921037733
0.19110205583054327 |  0.8287411944078148 0.53238125176025353  1.0696471947114767
1.8582732084451083 |  -3.3981902238558779 -0.62392379344118509 0.058915575756753505
0.96312088997284584 |  -0.23246423301959715 -0.010677030598000382   0.91452416890146704
0.26801101187541093 | 0.34001387139197792 0.84964785580594815  1.1966751768976516
0.31854717065106314 | 0.37591155067784454  0.9185350185405432  1.2152490309104735
0 | 0.76581549209968713  1.0625169735356792 0.76779446823853792
1480.8199040598579 | -1083.4685579068214  115.10309180664919 -1001.4343639708552
0.1188009283575841 |  0.3526032414753616  1.2036970603269825 0.68535566890512967
0.45796098845305783 | 0.64050595899442486 0.56306030004999741  1.0461500399329871


    // Notes
    // 1) autodiff runs twice as fast
    // 2) perturbations above a certain treshold make optimization not converge
    // 3) adding large outliers make optimization not converge
    // 4) not even using a Huber loss helps
    // 5) pose errors are averaged out and slightly reduced
    // 6) map errors increase
    // 7) reprojection errors decrease drastically
    // 8) -> scale ambiguity, fix a pose and a map point
    // 9) now pose errors are much lower (they were .2), and they increase as time increases, to be expected?).
    //    Map points are better apart from 2 large outliers (?)
    //    Pose errors after optimization:
    //    0
    //    0.01791161869422029
    //    0.02346511678199089
    //    0.026982826378678926
    //    0.0371614501770633
    //    Map errors after optimization:
    //    0
    //    0.024840395914591456
    //    0.093004283293719486
    //    0.049394236301493352
    //    0.028589798394583421
    //    0.15847544563464272
    //    0.10603251824330331
    //    0.066467253281677532
    //    0.66709619830411182
    //    0.042044582560245493
    //    0.10740345080902573
    //    1.9959865304447988
    //    0.30224908467118672
    //    0.088936535129609945
    //    0.010218351660408742
    //    0.15897312101451591
    //    3.9754683674080531
    //    0.45031045582085988
    //    0.079442148764633361
    //    Even worse if keep_constant = 15
    //    Pose errors after optimization:
    //    0
    //    0.016424707006456873
    //    0.021445867328087592
    //    0.027286074810309393
    //    0.038493247348242332
    //    Map errors after optimization:
    //    0.36424188460076729 | 0.72688446871620971 0.19295236199472934  1.0006107406876317
    //    0.33569179594020004 | 0.71440530112624556 0.31490037734909404 0.99747799127947689
    //    0.48244118065288505 | 0.57716932945071753 0.33319562182083079  1.0276424925006935
    //    0.46601562995688067 | 0.54154877377083344 0.18870233837013795 0.99988794689157789
    //    0.28437290672193072 | 0.7105047880788733 0.8536380459254993 1.0785024097277756
    //    0.14057464220234531 | 0.60902632781967347 0.93521191068384868 0.98669807038259405
    //    0.39058233524787267 | 0.87578975133244708 0.68689877605071703  1.0532952924015371
    //    0.1781773733856051 | 0.94331907799840509 0.73274669494646416 0.90236433119915171
    //    0.17869067391362314 | 0.45633098821654355  1.2758423232468488 0.63673247791319709
    //    0.25681347950645306 | 0.81659108865352481 0.47572158021871935  1.1078436921037733
    //    0.19110205583054327 |  0.8287411944078148 0.53238125176025353  1.0696471947114767
    //    1.8582732084451083 |  -3.3981902238558779 -0.62392379344118509 0.058915575756753505
    //    0.96312088997284584 |  -0.23246423301959715 -0.010677030598000382   0.91452416890146704
    //    0.26801101187541093 | 0.34001387139197792 0.84964785580594815  1.1966751768976516
    //    0.31854717065106314 | 0.37591155067784454  0.9185350185405432  1.2152490309104735
    //    0 | 0.76581549209968713  1.0625169735356792 0.76779446823853792
    //    1480.8199040598579 | -1083.4685579068214  115.10309180664919 -1001.4343639708552
    //    0.1188009283575841 |  0.3526032414753616  1.2036970603269825 0.68535566890512967
    //    0.45796098845305783 | 0.64050595899442486 0.56306030004999741  1.0461500399329871
    // 10) a 1-Huber loss yields a smaller pose error
    // 11) the unprojection thing mitigates the map errors without compromising the pose errors (no map points are fixed)
    //    Pose errors after optimization:
    //    0
    //    0.020483425969067801
    //    0.02566591770371696
    //    0.025357272160489591
    //    0.042645676865953532
    //    Map errors after optimization:
    //    0.062169476728595102 |   0.46451690490023995 0.0080638099297119948   0.71916812146518228
    //    0.0030551476519873307 | 0.49910698860233899  0.2084084869223056 0.76695031136765013
    //    0.052553730215327353 | 0.25221289542332359 0.21317761703528817 0.76397938960284717
    //    0.098186282384548185 |   0.19506769825354689 0.0054657382389065494   0.71320622171358727
    //    0.50568611363727034 | 0.38281215719997458 0.75537887056067499 0.38117479808621579
    //    0.13290988028325659 | 0.79994479893107473 0.77418049042331549  0.6362855527103034
    //    0.4980538897791375 | 0.27236296894955458  1.4092511643065555 0.43684355793205543
    //    0.16425028492514424 | 0.21708861022576573  0.6785386145609511   1.105823330805848
    //    0.28739376175871484 | 0.71821547769914773 0.84598195094039985  1.0835434171565521
    //    0.078575726562266593 | 0.45440664089722949  1.0000849444709765 0.84583015583159427
    //    0.20645472457513264 | 0.49668381603152439 0.38122271314707973 0.77528249960657969
    //    0.093085725176745071 | 0.64082543234449385 0.50086550285788678 0.85252801585128957
    //    0.29099349596260099 | -0.78456477731179763 -0.23460298320782166  0.65147360441882152
    //    0.2485401436619431 |   -1.918091305248157 -0.21432352079847117  0.56007153092818884
    //    0.34323090878748197 | 0.56242329119615553 0.55949401282280475 0.97743214157846292
    //    0.13321909158609815 | 0.47921703819761124  1.1986038859155808  0.6645699062819308
    //    0.1589715241932084 | 0.29736251955760179 0.47010162274977746 0.87928398895080162
    //    0.090990664969335472 |    0.45148419073483592 -0.0099704194108703563    0.66697813373471693
    //    0.034617255460647096 | 0.52423381988112416 0.22131796624773428 0.75095148206209583
    //  12) optimizing over the intrinsics too yield worse results and a weird intrinsic matrix (probably I'm not giving enough info?)

Obs. Such map errors are large but compatible. The main reason for this is a correspondence slighly off, so that the depth map changes drastically